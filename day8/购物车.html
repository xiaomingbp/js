<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Document</title>
	<style>
		input[type=text]{
			width:30px;
			text-align: center;
		}
	</style>
</head>
<body>
	<table border="1" cellspacing="0" width="800">
		<thead>
			<tr>
				<th><input type="checkbox" class="allchecked"><label for="">全选</label></th>
				<th>标题</th>
				<th>价格</th>
				<th>数量</th>
				<th>小计</th>
				<th>操作</th>
			</tr>
		</thead>
		<tbody class="list">
			<tr>
				<td><input type="checkbox"></td>
				<td>aaaaaaaaa</td>
				<td class="price">15</td>
				<td>
					<input type="button" class="jian" value="-">
					<input type="text" value="0">
					<input type="button" class="jia" value="+">
				</td>
				<td class="smallcount">0</td>
				<td><input type="button" value="删除"></td>
			</tr>
			<tr>
				<td><input type="checkbox"></td>
				<td>aaaaaaaaa</td>
				<td class="price">20</td>
				<td>
					<input type="button" class="jian" value="-">
					<input type="text" value="0">
					<input type="button" class="jia" value="+">
				</td>
				<td class="smallcount">0</td>
				<td><input type="button" value="删除"></td>
			</tr>
			<tr>
				<td><input type="checkbox"></td>
				<td>aaaaaaaaa</td>
				<td class="price">20</td>
				<td>
					<input type="button" class="jian" value="-">
					<input type="text"  value="0">
					<input type="button" class="jia" value="+">
				</td>
				<td class="smallcount">0</td>
				<td><input type="button" value="删除"></td>
			</tr>
		</tbody>
	</table>
	总计：<span class="allprice">0</span>
	<script>
		var tbody = document.querySelector(".list");
		var allprice = document.querySelector(".allprice");
		var allchecked = document.querySelector(".allchecked");
		function all_price(){
			var sum = 0;
			var smallcounts = [...document.querySelectorAll(".smallcount")]
			smallcounts.forEach(function(item){
				sum += item.innerHTML*1
			})
			allprice.innerHTML = sum;
		}

		tbody.addEventListener("click",function(e){
			if(e.target.classList.contains("jian")){
				if(e.target.nextElementSibling.value == 0){
					return;
				}
				e.target.nextElementSibling.value--;
				//小计
				var price = e.target.parentNode.previousElementSibling.innerHTML;
				var num = e.target.nextElementSibling.value;
				e.target.parentNode.nextElementSibling.innerHTML = price * num

				all_price()
			}
			if(e.target.classList.contains("jia")){
				e.target.previousElementSibling.value++;
				//小计
				var price = e.target.parentNode.previousElementSibling.innerHTML;
				var num = e.target.previousElementSibling.value;
				e.target.parentNode.nextElementSibling.innerHTML = price * num

				all_price()
			}

		});

		allchecked.addEventListener("click",function(){
			var checkboxs = [...tbody.querySelectorAll("input[type=checkbox]")];
			checkboxs.forEach(function(item){
				item.checked = allchecked.checked;
			})
		})
	</script>
</body>
</html>